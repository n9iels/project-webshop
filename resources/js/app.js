var Router=function(){function e(e,r){if(0!=t(e)){var i=n(e);switch(i[0]){case"":case"index.html":case"products":new ProductsController(new ProductsViewHelper,new ProductsModel).main();break;case"product":new ProductController(new ProductViewHelper,new ProductModel(i[1])).main();break;case"register":new RegisterController(new RegisterViewHelper,new RegisterModel).main();break;case"login":new LoginController(new LoginViewHelper,new LoginModel).main();break;case"logout":new LogoutController(new LogoutViewHelper,new LogoutModel).main();break;default:new ErrorController(new ErrorViewHelper).main()}0!=r&&(""==e&&(e="index.html"),o({},"A-Z Games",e))}}function t(e){return e.indexOf("http")==-1&&e.indexOf("https")==-1&&e.indexOf("www")==-1||(window.location=e,!1)}function n(e){return 0==e.indexOf("/")&&(e=e.substring(1)),null!=this.baseUrl&&e.indexOf(this.baseUrl)!=-1&&(e=e.substring(e.indexOf(this.baseUrl)+this.baseUrl.length)),e.split(/\/(.+)?/)}function o(e,t,n){window.history.pushState(e,t,n)}return baseUrl="project-webshop/",{route:e}},LoginModel=function(){function e(e,t,n){$.ajax({url:"http:///84.84.245.29:243/user/login",type:"post",dataType:"json",data:JSON.stringify({email:e,password:t}),success:function(e){document.cookie="access_token="+e.access_token,document.cookie="user_id="+e.user_id,n(e)},error:function(e,t,n){$("#error_message").show()}})}return{login:e}},LogoutModel=function(){function e(e){function t(e){for(var t=document.cookie.split(";"),n=0;n<t.length;n++){var o=t[n].split("=");if(o[0].trim()==e)return o[1]}}$.ajax({url:"http://84.84.245.29:243/user/logout",type:"post",dataType:"json",data:JSON.stringify({user_id:t("user_id")}),success:function(t){document.cookie="access_token=",document.cookie="user_id=",e(t)},error:function(e,t,n){$("#error_message").show()}})}return{logout:e}},PageModel=function(){function e(e){$.ajax({url:"http://84.84.245.29:243/user",type:"get",dataType:"json",headers:{Authorization:"Bearer "+t("access_token")},success:function(t){e(t)},error:function(e,t,n){$("#component").load("error.html")}})}function t(e){for(var t=document.cookie.split(";"),n=0;n<t.length;n++){var o=t[n].split("=");if(o[0]==e)return o[1]}}return{getPage:e}},ProductsModel=function(){function e(e,t){$.ajax({url:"http://84.84.245.29:243/products?"+e,type:"get",dataType:"json",success:function(e){t(e)},error:function(e,t,n){$("#component").load("views/error/error.html")}})}return{getPage:e}},RegisterModel=function(){function e(e,t){$.ajax({url:"http://84.84.245.29:243/user/register",type:"post",dataType:"json",data:JSON.stringify({e_mail:e.e_mailadres,password:e.wachtwoord,first_name:e.voornaam,surname:e.achternaam,gender:e.gender,date_of_birth:e.birth_date,phone_number:e.mobiel_nummer,secret_question:e.security_question,secret_question_answer:e.security_answer}),success:function(e){t(e),console.log(e)},error:function(e,t,n){$("#regi_api_error_message").show()}})}return{register:e}},ProductModel=function(e){function t(t){$.ajax({url:"http://84.84.245.29:243/products/"+e,type:"get",dataType:"json",success:function(e){t(e[0]),console.log(e)},error:function(e,t,n){console.log("something wrong with API, BITCH")}})}return{GetProductInfo:t}},ErrorController=function(e){function t(){n.setView()}var n=e;return{main:t}},LoginController=function(e,t){function n(e){e.preventDefault();var t={};$.each($(this).serializeArray(),function(e,n){t[n.name]=n.value}),r.login(t.email,t.password,function(e){$("#inloggen_text").hide(),$("#uitloggen_text").show(),new PageController(new PageViewHelper,new PageModel).main()})}function o(){i.setView(),i.setActionListener(n)}var r=t,i=e;return{main:o}},LogoutController=function(e,t){function n(e){r.logout(function(e){$("#inloggen_text").show(),$("#uitloggen_text").hide(),i.setView()})}function o(){i.setActionListener(n)}var r=t,i=e;return{main:o}},PageController=function(e,t){function n(e){r.getPage(function(e){i.setView(e)})}function o(){i.setActionListener(n)}var r=t,i=e;return{main:o}},ProductsController=function(e,t){function n(){i.getPage("",function(e){s.setView(e)})}function o(e){e.preventDefault();var t=$(this).serialize();i.getPage(t,function(e){s.loadProducts(e)})}function r(){s.setActionListener(n),s.setFilterListener(o)}var i=t,s=e;return{main:r}},RegisterController=function(e,t){function n(){console.log("in actionPerformed"),event.preventDefault(),$("#regi_api_error_message").hide(),$("#ww2_error_message").hide();var e={};$.each($(this).serializeArray(),function(t,n){e[n.name]=n.value}),e.birth_date=e.jaar+"-"+e.maand+"-"+e.dag;var t=!1,n=["voornaam","achternaam","postcode","huisnummer","e_mailadres","wachtwoord","wachtwoord2","security_answer"];$.each(n,function(e,t){$("#"+t).removeClass("invalid")}),$.each(n,function(n,o){""==e[o]&&($("#"+o).addClass("invalid"),t=!0)}),t&&(window.scrollTo(0,0),$("#register_error_message").show());var o=!1;return e.wachtwoord!=e.wachtwoord2&&(o=!0,$("#ww2_error_message").show(),$("#wachtwoord").addClass("invalid"),$("#wachtwoord2").addClass("invalid")),!t&&!o&&(console.log("function not aborted"),console.log(e),void r.register(e,function(e){i.setView("views/register/after_register.html")}))}function o(){i.setView("views/register/register.html"),i.setActionListener(n)}var r=t,i=e;return{main:o}},ProductController=function(e,t){function n(t){e.setView(t)}function o(){t.GetProductInfo(n)}return{main:o,showView:n}},ErrorViewHelper=function(){function e(){$("#component").load("views/error/error.html")}function t(e){$(document).ready(e)}return{setView:e,setActionListener:t}},LoginViewHelper=function(){function e(){$("#component").load("views/login/login.html")}function t(e){$("#component").on("submit","#loginform",e)}return{setView:e,setActionListener:t}},LogoutViewHelper=function(){function e(){$("#component").load("views/logout/logout.html")}function t(e){$(document).ready(e)}return{setView:e,setActionListener:t}},ProductsViewHelper=function(){function e(e){$("#component").html('<div class="col-12"><div class="col-3" id="filters"></div><div class="col-9" id="products"></div></div>'),$("#filters").load("views/products/filters.html"),t(e)}function t(e){$("#products").load("views/products/products.html",function(){$.each(e,function(e,t){var r=$("<div>").append($("#product__list__item").clone());$(r).find(".product__title").html(t.title),$(r).find(".product__subtitle").append(t.genre+" | "+t.pegi_age+" | "+o(t.platform)),$(r).find(".product__description").html(n(t.description)),$(r).find(".product__price").append("€ "+t.price),$(r).find("#buttons__info").attr("href","product/"+t.ean_number),$(r).find(".product__image img").attr("src",t.image),$("#product__list").append(r)}),$("#product__list__item").first().remove()})}function n(e){var t=50,n=e.split(" ");if(n.length>t){var o="";for(i=0;i<t;i++)o+=n[i]+" ";return o+"..."}return e}function o(e){return"PS4"===e.toUpperCase()?"<img src='https://maxcdn.icons8.com/Android_L/PNG/48/Logos/play_station_copyrighted-48.png' />":"PC"===e.toUppercase()?"<img src='https://maxcdn.icons8.com/Color/PNG/48/Operating_Systems/windows_logo_copyrighted-48.png' />":"XBOX"===e.toUppercase()?"<img src='https://maxcdn.icons8.com/Color/PNG/48/Logos/xbox-48.png' />":e}function r(e){$(document).ready(e)}function s(e){$("#component").on("change","input[type=checkbox]",function(e){$("#product_filter").submit()}),$("#component").on("submit","#product_filter",e)}return{setView:e,loadProducts:t,setActionListener:r,setFilterListener:s}},RegisterViewHelper=function(){function e(e){$("#component").load(e)}function t(e){$("#component").on("submit","#registerform",e)}return{setView:e,setActionListener:t}},PageViewHelper=function(){function e(e){$("#component").load("views/page/page.html",function(){"customer"==e[0].user_type&&$("#user-block").append("<h1>Je lees dit alleen als je een customer bent"),"admin"==e[0].user_type&&$("#user-block").append("<h1>Je lees dit alleen als je een administrator bent")})}function t(e){$(document).ready(e)}return{setView:e,setActionListener:t}},ProductViewHelper=function(){function e(e){t(e)}function t(e){$("#component").load("views/single_product/single_product.html",function(){$(".product__image img").attr("src",e.image),$(".product__title").html(e.title),$(".product__price").html("€ "+e.price),$(".liproduct__ean").append(e.ean_number),$(".liproduct__platform").append(e.platform);var t=new Date(e.release_date),n=["januari","februari","maart","april","mei","juni","juli","augustus","september","oktober","november","december"];$(".liproduct__releasedate").append(t.getDay()+" "+n[t.getMonth()]+" "+t.getFullYear()),$(".liproduct__pegi").append(e.pegi_age),$(".liproduct__publisher").append(e.publisher),$(".liproduct__title").append(e.title),$(".liproduct__subtitle").append(e.subtitle),$(".liproduct__genre").append(e.genre),$(".liproduct__franchise").append(e.franchise),$(".product__descr").html(e.description)})}return{setView:e,loadProduct:t}};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJvdXRlci5qcyIsImxvZ2luX21vZGVsLmpzIiwibG9nb3V0X21vZGVsLmpzIiwicGFnZV9tb2RlbC5qcyIsInByb2R1Y3RzX21vZGVsLmpzIiwicmVnaXN0ZXJfbW9kZWwuanMiLCJzaW5nbGVfcHJvZHVjdF9tb2RlbC5qcyIsImVycm9yX2NvbnRyb2xsZXIuanMiLCJsb2dpbl9jb250cm9sbGVyLmpzIiwibG9nb3V0X2NvbnRyb2xsZXIuanMiLCJwYWdlX2NvbnRyb2xsZXIuanMiLCJwcm9kdWN0c19jb250cm9sbGVyLmpzIiwicmVnaXN0ZXJfY29udHJvbGxlci5qcyIsInNpbmdsZV9wcm9kdWN0X2NvbnRyb2xsZXIuanMiLCJlcnJvci9lcnJvcl92aWV3LmpzIiwibG9naW4vbG9naW5fdmlldy5qcyIsImxvZ291dC9sb2dvdXRfdmlldy5qcyIsInByb2R1Y3RzL3Byb2R1Y3RzX3ZpZXcuanMiLCJyZWdpc3Rlci9yZWdpc3Rlcl92aWV3LmpzIiwicGFnZS9wYWdlX3ZpZXcuanMiLCJzaW5nbGVfcHJvZHVjdC9zaW5nbGVfcHJvZHVjdF92aWV3LmpzIl0sIm5hbWVzIjpbIlJvdXRlciIsInJvdXRlIiwidXJsIiwiaGlzdG9yeSIsImlzSW50ZXJuYWwiLCJwYXJ0aWNsZXMiLCJnZXRQYXJ0aWNsZXMiLCJQcm9kdWN0c0NvbnRyb2xsZXIiLCJQcm9kdWN0c1ZpZXdIZWxwZXIiLCJQcm9kdWN0c01vZGVsIiwibWFpbiIsIlByb2R1Y3RDb250cm9sbGVyIiwiUHJvZHVjdFZpZXdIZWxwZXIiLCJQcm9kdWN0TW9kZWwiLCJSZWdpc3RlckNvbnRyb2xsZXIiLCJSZWdpc3RlclZpZXdIZWxwZXIiLCJSZWdpc3Rlck1vZGVsIiwiTG9naW5Db250cm9sbGVyIiwiTG9naW5WaWV3SGVscGVyIiwiTG9naW5Nb2RlbCIsIkxvZ291dENvbnRyb2xsZXIiLCJMb2dvdXRWaWV3SGVscGVyIiwiTG9nb3V0TW9kZWwiLCJFcnJvckNvbnRyb2xsZXIiLCJFcnJvclZpZXdIZWxwZXIiLCJ3cml0ZUhpc3RvcnkiLCJpbmRleE9mIiwid2luZG93IiwibG9jYXRpb24iLCJzdWJzdHJpbmciLCJ0aGlzIiwiYmFzZVVybCIsImxlbmd0aCIsInNwbGl0Iiwib2JqZWN0IiwidGl0bGUiLCJwdXNoU3RhdGUiLCJsb2dpbiIsImVtYWlsIiwicGFzc3dvcmQiLCJjYWxsYmFjayIsIiQiLCJhamF4IiwidHlwZSIsImRhdGFUeXBlIiwiZGF0YSIsIkpTT04iLCJzdHJpbmdpZnkiLCJzdWNjZXNzIiwiZG9jdW1lbnQiLCJjb29raWUiLCJhY2Nlc3NfdG9rZW4iLCJ1c2VyX2lkIiwiZXJyb3IiLCJ4aHIiLCJzdGF0dXMiLCJzaG93IiwibG9nb3V0IiwiZ2V0Q29va2llIiwibmFtZSIsImNvb2tpZXMiLCJpIiwidHJpbSIsIlBhZ2VNb2RlbCIsImdldFBhZ2UiLCJoZWFkZXJzIiwiQXV0aG9yaXphdGlvbiIsImxvYWQiLCJmaWx0ZXIiLCJyZWdpc3RlciIsImZvcm1EYXRhIiwiZV9tYWlsIiwiZV9tYWlsYWRyZXMiLCJ3YWNodHdvb3JkIiwiZmlyc3RfbmFtZSIsInZvb3JuYWFtIiwic3VybmFtZSIsImFjaHRlcm5hYW0iLCJnZW5kZXIiLCJkYXRlX29mX2JpcnRoIiwiYmlydGhfZGF0ZSIsInBob25lX251bWJlciIsIm1vYmllbF9udW1tZXIiLCJzZWNyZXRfcXVlc3Rpb24iLCJzZWN1cml0eV9xdWVzdGlvbiIsInNlY3JldF9xdWVzdGlvbl9hbnN3ZXIiLCJzZWN1cml0eV9hbnN3ZXIiLCJjb25zb2xlIiwibG9nIiwiZWFuIiwiR2V0UHJvZHVjdEluZm8iLCJ2aWV3SGVscGVyIiwiVmlld0hlbHBlciIsInNldFZpZXciLCJtb2RlbCIsImFjdGlvblBlcmZvcm1lZCIsImV2ZW50IiwicHJldmVudERlZmF1bHQiLCJlYWNoIiwic2VyaWFsaXplQXJyYXkiLCJmaWVsZCIsInZhbHVlIiwiTW9kZWwiLCJoaWRlIiwiUGFnZUNvbnRyb2xsZXIiLCJQYWdlVmlld0hlbHBlciIsInNldEFjdGlvbkxpc3RlbmVyIiwiVmlldyIsImZpbHRlclByb2R1Y3RzIiwiZmlsdGVycyIsInNlcmlhbGl6ZSIsImxvYWRQcm9kdWN0cyIsInNldEZpbHRlckxpc3RlbmVyIiwiamFhciIsIm1hYW5kIiwiZGFnIiwibWFuZGF0b3J5RmllbGRNaXNzZXMiLCJtYW5kYXRvcnlGaWVsZHMiLCJtYW5GaWVsZCIsInJlbW92ZUNsYXNzIiwiYWRkQ2xhc3MiLCJzY3JvbGxUbyIsInBhc3N3b3Jkc05vdElkZW50aWNhbCIsIndhY2h0d29vcmQyIiwic2hvd1ZpZXciLCJldmVudEhhbmRsZXIiLCJyZWFkeSIsImFjdGlvbiIsIm9uIiwidmlld0RhdGEiLCJodG1sIiwia2V5IiwicHJvZHVjdCIsImFwcGVuZCIsImNsb25lIiwiZmluZCIsImdlbnJlIiwicGVnaV9hZ2UiLCJQbGF0Zm9ybUxvZ28iLCJwbGF0Zm9ybSIsIkN1dFN0cmluZyIsImRlc2NyaXB0aW9uIiwicHJpY2UiLCJhdHRyIiwiZWFuX251bWJlciIsImltYWdlIiwiZmlyc3QiLCJyZW1vdmUiLCJ0ZXh0IiwiU2hvd0Ftb3VudCIsIldvcmRzQXJyYXkiLCJTaG9ydFN0cmluZyIsInBsYXRmb3JtbmFhbSIsInRvVXBwZXJDYXNlIiwidG9VcHBlcmNhc2UiLCJzdWJtaXQiLCJ2aWV3VG9TaG93IiwidXNlcl90eXBlIiwibG9hZFByb2R1Y3QiLCJkIiwiRGF0ZSIsInJlbGVhc2VfZGF0ZSIsIm1vbnRocyIsImdldERheSIsImdldE1vbnRoIiwiZ2V0RnVsbFllYXIiLCJwdWJsaXNoZXIiLCJzdWJ0aXRsZSIsImZyYW5jaGlzZSJdLCJtYXBwaW5ncyI6IkFBQUEsR0FBQUEsUUFBQSxXQUlBLFFBQUFDLEdBQUFDLEVBQUFDLEdBRUEsR0FBQSxHQUFBQyxFQUFBRixHQUFBLENBS0EsR0FBQUcsR0FBQUMsRUFBQUosRUFFQSxRQUFBRyxFQUFBLElBRUEsSUFBQSxHQUNBLElBQUEsYUFDQSxJQUFBLFdBQ0EsR0FBQUUsb0JBQUEsR0FBQUMsb0JBQUEsR0FBQUMsZ0JBQUFDLE1BQ0Es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cUJBQUE0RixPQUFBRCxFQUFBakcsT0FDQU0sRUFBQSx3QkFBQTRGLE9BQUFELEVBQUFtQyxVQUNBOUgsRUFBQSxxQkFBQTRGLE9BQUFELEVBQUFJLE9BQ0EvRixFQUFBLHlCQUFBNEYsT0FBQUQsRUFBQW9DLFdBRUEvSCxFQUFBLG1CQUFBeUYsS0FBQUUsRUFBQVMsZUE0Q0EsT0FDQWhELFFBQUFBLEVBQ0FpRSxZQUFBQSIsImZpbGUiOiJhcHAuanMiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgUm91dGVyID0gZnVuY3Rpb24gKClcclxue1xyXG4gICAgYmFzZVVybCA9IFwicHJvamVjdC13ZWJzaG9wL1wiO1xyXG5cclxuICAgIGZ1bmN0aW9uIHJvdXRlKHVybCwgaGlzdG9yeSlcclxuICAgIHtcclxuICAgICAgICBpZiAoaXNJbnRlcm5hbCh1cmwpID09IGZhbHNlKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIHBhcnRpY2xlcyA9IGdldFBhcnRpY2xlcyh1cmwpO1xyXG5cclxuICAgICAgICBzd2l0Y2gocGFydGljbGVzWzBdKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgY2FzZSBcIlwiOlxyXG4gICAgICAgICAgICBjYXNlIFwiaW5kZXguaHRtbFwiOlxyXG4gICAgICAgICAgICBjYXNlIFwicHJvZHVjdHNcIjpcclxuICAgICAgICAgICAgICAgIG5ldyBQcm9kdWN0c0NvbnRyb2xsZXIobmV3IFByb2R1Y3RzVmlld0hlbHBlcigpLCBuZXcgUHJvZHVjdHNNb2RlbCgpKS5tYWluKCk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBcInByb2R1Y3RcIjpcclxuICAgICAgICAgICAgICAgIG5ldyBQcm9kdWN0Q29udHJvbGxlcihuZXcgUHJvZHVjdFZpZXdIZWxwZXIoKSwgbmV3IFByb2R1Y3RNb2RlbChwYXJ0aWNsZXNbMV0pKS5tYWluKCk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBcInJlZ2lzdGVyXCI6XHJcbiAgICAgICAgICAgICAgICBuZXcgUmVnaXN0ZXJDb250cm9sbGVyKG5ldyBSZWdpc3RlclZpZXdIZWxwZXIoKSwgbmV3IFJlZ2lzdGVyTW9kZWwoKSkubWFpbigpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgXCJsb2dpblwiOlxyXG4gICAgICAgICAgICAgICAgbmV3IExvZ2luQ29udHJvbGxlcihuZXcgTG9naW5WaWV3SGVscGVyKCksIG5ldyBMb2dpbk1vZGVsKCkpLm1haW4oKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIFwibG9nb3V0XCI6XHJcbiAgICAgICAgICAgICAgICBuZXcgTG9nb3V0Q29udHJvbGxlcihuZXcgTG9nb3V0Vmlld0hlbHBlcigpLCBuZXcgTG9nb3V0TW9kZWwoKSkubWFpbigpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICBuZXcgRXJyb3JDb250cm9sbGVyKG5ldyBFcnJvclZpZXdIZWxwZXIoKSkubWFpbigpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoaGlzdG9yeSAhPSBmYWxzZSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmICh1cmwgPT0gXCJcIilcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgdXJsID0gXCJpbmRleC5odG1sXCI7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHdyaXRlSGlzdG9yeSh7fSwgXCJBLVogR2FtZXNcIiwgdXJsKVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBpc0ludGVybmFsKHVybClcclxuICAgIHtcclxuICAgICAgICBpZiAodXJsLmluZGV4T2YoXCJodHRwXCIpICE9IC0xIHx8IHVybC5pbmRleE9mKFwiaHR0cHNcIikgIT0gLTEgfHwgdXJsLmluZGV4T2YoXCJ3d3dcIikgIT0gLTEpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB3aW5kb3cubG9jYXRpb24gPSB1cmw7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBnZXRQYXJ0aWNsZXModXJsKVxyXG4gICAge1xyXG4gICAgICAgIC8vIFJlbW92ZSB0aGUgZmlyc3QgL1xyXG4gICAgICAgIGlmICh1cmwuaW5kZXhPZihcIi9cIikgPT0gMClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHVybCA9IHVybC5zdWJzdHJpbmcoMSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBJZiB0aGVyZSBpcyBhIGJhc2UgdXJsIHNldCwgcmVtb3ZlIHRoZSBiYXNlIHVybFxyXG4gICAgICAgIGlmICh0aGlzLmJhc2VVcmwgIT0gbnVsbCAmJiB1cmwuaW5kZXhPZih0aGlzLmJhc2VVcmwpICE9IC0xKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgdXJsID0gdXJsLnN1YnN0cmluZyh1cmwuaW5kZXhPZih0aGlzLmJhc2VVcmwpICsgdGhpcy5iYXNlVXJsLmxlbmd0aCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gdXJsLnNwbGl0KC9cXC8oLispPy8pXHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gd3JpdGVIaXN0b3J5KG9iamVjdCwgdGl0bGUsIHVybClcclxuICAgIHtcclxuICAgICAgICB3aW5kb3cuaGlzdG9yeS5wdXNoU3RhdGUob2JqZWN0LCB0aXRsZSwgdXJsKTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIHJvdXRlOiByb3V0ZVxyXG4gICAgfVxyXG59IiwidmFyIExvZ2luTW9kZWwgPSBmdW5jdGlvbigpXHJcbntcclxuICAgIGZ1bmN0aW9uIGxvZ2luKGVtYWlsLCBwYXNzd29yZCwgY2FsbGJhY2spXHJcbiAgICB7XHJcbiAgICAgICAgJC5hamF4KHtcclxuICAgICAgICAgICAgdXJsOiBcImh0dHA6Ly8vODQuODQuMjQ1LjI5OjI0My91c2VyL2xvZ2luXCIsXHJcbiAgICAgICAgICAgIHR5cGU6IFwicG9zdFwiLFxyXG4gICAgICAgICAgICBkYXRhVHlwZTogJ2pzb24nLFxyXG4gICAgICAgICAgICBkYXRhOiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgICAgICAgICBlbWFpbCA6IGVtYWlsLFxyXG4gICAgICAgICAgICAgICAgcGFzc3dvcmQgOiBwYXNzd29yZFxyXG4gICAgICAgICAgICB9KSxcclxuICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgIC8vIHB1dCB0b2tlbiBpbiBjb29raWVcclxuICAgICAgICAgICAgICAgIGRvY3VtZW50LmNvb2tpZT0nYWNjZXNzX3Rva2VuPScgKyBkYXRhLmFjY2Vzc190b2tlbjtcclxuICAgICAgICAgICAgICAgIGRvY3VtZW50LmNvb2tpZT0ndXNlcl9pZD0nICsgZGF0YS51c2VyX2lkO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIGxldCBjb250cm9sbGVyIHJlc3VtZSB3aXRoIHN0dWZmXHJcbiAgICAgICAgICAgICAgICBjYWxsYmFjayhkYXRhKTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uICh4aHIsIHN0YXR1cywgZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgIC8vIHNob3cgJ25vdCBnb29kIGVtYWlsIG9yIHBhc3N3b3JkIHRvIHVzZXInXHJcbiAgICAgICAgICAgICAgICAkKFwiI2Vycm9yX21lc3NhZ2VcIikuc2hvdygpO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vJChcIiNjb21wb25lbnRcIikuaHRtbChcImVycm9yIGZ1bmN0aW9uXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gUmV0dXJuIHRoZSBtZXRob2RzIHRoYXQgY2FuIGJlIHVzZWQgYnkgb3RoZXIgcHJvZ3JhbXMgKHRoZSBjb250cm9sbGVyIGluIHRoaXMgY2FzZSlcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgbG9naW46IGxvZ2luXHJcbiAgICB9XHJcbn07IiwidmFyIExvZ291dE1vZGVsID0gZnVuY3Rpb24oKVxyXG57XHJcbiAgICBmdW5jdGlvbiBsb2dvdXQoY2FsbGJhY2spXHJcbiAgICB7XHJcbiAgICAgICAgJC5hamF4KHtcclxuICAgICAgICAgICAgdXJsOiBcImh0dHA6Ly84NC44NC4yNDUuMjk6MjQzL3VzZXIvbG9nb3V0XCIsIC8vPyBodHRwOi8vODQuODQuMjQ1LjI5OjI0MyA9IEFQSS1sb2NhdGllP1xyXG4gICAgICAgICAgICB0eXBlOiBcInBvc3RcIixcclxuICAgICAgICAgICAgZGF0YVR5cGU6ICdqc29uJyxcclxuICAgICAgICAgICAgZGF0YTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgICAgICAgICAgdXNlcl9pZDogZ2V0Q29va2llKFwidXNlcl9pZFwiKVxyXG4gICAgICAgICAgICB9KSxcclxuICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgIC8vIGxldCBjb250cm9sbGVyIHJlc3VtZSB3aXRoIHN0dWZmXHJcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5jb29raWU9J2FjY2Vzc190b2tlbj0nO1xyXG4gICAgICAgICAgICAgICAgZG9jdW1lbnQuY29va2llPSd1c2VyX2lkPSc7XHJcbiAgICAgICAgICAgICAgICBjYWxsYmFjayhkYXRhKTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uICh4aHIsIHN0YXR1cywgZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgIC8vIHNob3cgJ25vdCBnb29kIGVtYWlsIG9yIHBhc3N3b3JkIHRvIHVzZXInXHJcbiAgICAgICAgICAgICAgICAkKFwiI2Vycm9yX21lc3NhZ2VcIikuc2hvdygpO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vJChcIiNjb21wb25lbnRcIikuaHRtbChcImVycm9yIGZ1bmN0aW9uXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGdldENvb2tpZShuYW1lKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgdmFyIGNvb2tpZXMgPSBkb2N1bWVudC5jb29raWUuc3BsaXQoJzsnKTtcclxuXHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY29va2llcy5sZW5ndGg7IGkrKylcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgdmFyIGNvb2tpZSA9IGNvb2tpZXNbaV0uc3BsaXQoXCI9XCIpO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChjb29raWVbMF0udHJpbSgpID09IG5hbWUpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvb2tpZVsxXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBSZXR1cm4gdGhlIG1ldGhvZHMgdGhhdCBjYW4gYmUgdXNlZCBieSBvdGhlciBwcm9ncmFtcyAodGhlIGNvbnRyb2xsZXIgaW4gdGhpcyBjYXNlKVxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBsb2dvdXQ6IGxvZ291dFxyXG4gICAgfVxyXG59OyIsInZhciBQYWdlTW9kZWwgPSBmdW5jdGlvbigpXHJcbntcclxuICAgIGZ1bmN0aW9uIGdldFBhZ2UoY2FsbGJhY2spXHJcbiAgICB7XHJcbiAgICAgICAgJC5hamF4KHtcclxuICAgICAgICAgICAgdXJsOiBcImh0dHA6Ly84NC44NC4yNDUuMjk6MjQzL3VzZXJcIixcclxuICAgICAgICAgICAgdHlwZTogXCJnZXRcIixcclxuICAgICAgICAgICAgZGF0YVR5cGU6ICdqc29uJyxcclxuICAgICAgICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICAgICAgICAgXCJBdXRob3JpemF0aW9uXCI6IFwiQmVhcmVyIFwiICsgZ2V0Q29va2llKFwiYWNjZXNzX3Rva2VuXCIpXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICBjYWxsYmFjayhkYXRhKTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uICh4aHIsIHN0YXR1cywgZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgICQoXCIjY29tcG9uZW50XCIpLmxvYWQoXCJlcnJvci5odG1sXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gZ2V0Q29va2llKG5hbWUpXHJcbiAgICB7XHJcbiAgICAgICAgdmFyIGNvb2tpZXMgPSBkb2N1bWVudC5jb29raWUuc3BsaXQoJzsnKTtcclxuXHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjb29raWVzLmxlbmd0aDsgaSsrKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgdmFyIGNvb2tpZSA9IGNvb2tpZXNbaV0uc3BsaXQoXCI9XCIpO1xyXG5cclxuICAgICAgICAgICAgaWYgKGNvb2tpZVswXSA9PSBuYW1lKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gY29va2llWzFdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIFJldHVybiB0aGUgbWV0aG9kcyB0aGF0IGNhbiBiZSB1c2VkIGJ5IG90aGVyIHByb2dyYW1zICh0aGUgY29udHJvbGxlciBpbiB0aGlzIGNhc2UpXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIGdldFBhZ2U6IGdldFBhZ2VcclxuICAgIH1cclxufTsiLCJ2YXIgUHJvZHVjdHNNb2RlbCA9IGZ1bmN0aW9uKClcclxue1xyXG4gICAgZnVuY3Rpb24gZ2V0UGFnZShmaWx0ZXIsIGNhbGxiYWNrKVxyXG4gICAge1xyXG4gICAgICAgICQuYWpheCh7XHJcbiAgICAgICAgICAgIHVybDogXCJodHRwOi8vODQuODQuMjQ1LjI5OjI0My9wcm9kdWN0cz9cIiArIGZpbHRlciwgLy8/IGh0dHA6Ly84NC44NC4yNDUuMjk6MjQzID0gQVBJLWxvY2F0aWU/XHJcbiAgICAgICAgICAgIHR5cGU6IFwiZ2V0XCIsXHJcbiAgICAgICAgICAgIGRhdGFUeXBlOiAnanNvbicsXHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICBjYWxsYmFjayhkYXRhKTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uICh4aHIsIHN0YXR1cywgZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgICQoXCIjY29tcG9uZW50XCIpLmxvYWQoXCJ2aWV3cy9lcnJvci9lcnJvci5odG1sXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gUmV0dXJuIHRoZSBtZXRob2RzIHRoYXQgY2FuIGJlIHVzZWQgYnkgb3RoZXIgcHJvZ3JhbXMgKHRoZSBjb250cm9sbGVyIGluIHRoaXMgY2FzZSlcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgZ2V0UGFnZTogZ2V0UGFnZVxyXG4gICAgfVxyXG59OyIsInZhciBSZWdpc3Rlck1vZGVsID0gZnVuY3Rpb24oKVxyXG57XHJcbiAgICBmdW5jdGlvbiByZWdpc3Rlcihmb3JtRGF0YSwgY2FsbGJhY2spXHJcbiAgICB7XHJcbiAgICAgICAgJC5hamF4KHtcclxuICAgICAgICAgICAgdXJsOiBcImh0dHA6Ly84NC44NC4yNDUuMjk6MjQzL3VzZXIvcmVnaXN0ZXJcIiwgLy9odHRwOi8vbG9jYWxob3N0OjgwODAvdXNlci9yZWdpc3RlclxyXG4gICAgICAgICAgICB0eXBlOiBcInBvc3RcIixcclxuICAgICAgICAgICAgZGF0YVR5cGU6ICdqc29uJyxcclxuICAgICAgICAgICAgZGF0YTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgICAgICAgICAgZV9tYWlsIDogZm9ybURhdGEuZV9tYWlsYWRyZXMsXHJcbiAgICAgICAgICAgICAgICBwYXNzd29yZCA6IGZvcm1EYXRhLndhY2h0d29vcmQsXHJcbiAgICAgICAgICAgICAgICBmaXJzdF9uYW1lIDogZm9ybURhdGEudm9vcm5hYW0sXHJcbiAgICAgICAgICAgICAgICBzdXJuYW1lIDogZm9ybURhdGEuYWNodGVybmFhbSxcclxuICAgICAgICAgICAgICAgIGdlbmRlciA6IGZvcm1EYXRhLmdlbmRlcixcclxuICAgICAgICAgICAgICAgIGRhdGVfb2ZfYmlydGggOiBmb3JtRGF0YS5iaXJ0aF9kYXRlLFxyXG4gICAgICAgICAgICAgICAgcGhvbmVfbnVtYmVyIDogZm9ybURhdGEubW9iaWVsX251bW1lcixcclxuICAgICAgICAgICAgICAgIHNlY3JldF9xdWVzdGlvbiA6IGZvcm1EYXRhLnNlY3VyaXR5X3F1ZXN0aW9uLFxyXG4gICAgICAgICAgICAgICAgc2VjcmV0X3F1ZXN0aW9uX2Fuc3dlciA6IGZvcm1EYXRhLnNlY3VyaXR5X2Fuc3dlclxyXG4gICAgICAgICAgICB9KSxcclxuICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgIC8vIGxldCBjb250cm9sbGVyIHJlc3VtZSB3aXRoIHN0dWZmXHJcbiAgICAgICAgICAgICAgICBjYWxsYmFjayhkYXRhKTtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGEpOyAvL3Rlc3RcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uICh4aHIsIHN0YXR1cywgZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgIC8vIHNob3cgJ2VtYWlsIGFsIGdlYm9uZGVuIGFhbiBlZW4gYWNjb3VudD8nXHJcbiAgICAgICAgICAgICAgICAkKFwiI3JlZ2lfYXBpX2Vycm9yX21lc3NhZ2VcIikuc2hvdygpO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vJChcIiNjb21wb25lbnRcIikuaHRtbChcImVycm9yIGZ1bmN0aW9uXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gUmV0dXJuIHRoZSBtZXRob2RzIHRoYXQgY2FuIGJlIHVzZWQgYnkgb3RoZXIgcHJvZ3JhbXMgKHRoZSBjb250cm9sbGVyIGluIHRoaXMgY2FzZSlcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgcmVnaXN0ZXI6IHJlZ2lzdGVyXHJcbiAgICB9XHJcbn07IiwidmFyIFByb2R1Y3RNb2RlbCA9IGZ1bmN0aW9uKGVhbilcclxue1xyXG4gICAgZnVuY3Rpb24gR2V0UHJvZHVjdEluZm8oY2FsbGJhY2spXHJcbiAgICB7XHJcbiAgICAgICAgJC5hamF4KHtcclxuICAgICAgICAgICAgdXJsOiBcImh0dHA6Ly84NC44NC4yNDUuMjk6MjQzL3Byb2R1Y3RzL1wiICsgZWFuLCAvL2h0dHA6Ly9sb2NhbGhvc3Q6ODA4MC91c2VyL3JlZ2lzdGVyXHJcbiAgICAgICAgICAgIHR5cGU6IFwiZ2V0XCIsXHJcbiAgICAgICAgICAgIGRhdGFUeXBlOiAnanNvbicsXHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBsZXQgY29udHJvbGxlciByZXN1bWUgd2l0aCBzdHVmZlxyXG4gICAgICAgICAgICAgICAgY2FsbGJhY2soZGF0YVswXSk7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTsgLy90ZXN0XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbiAoeGhyLCBzdGF0dXMsIGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInNvbWV0aGluZyB3cm9uZyB3aXRoIEFQSSwgQklUQ0hcIik7XHJcblxyXG5cclxuXHJcbiAgICAgICAgICAgICAgICAvLyQoXCIjcmVnaV9hcGlfZXJyb3JfbWVzc2FnZVwiKS5zaG93KCk7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8kKFwiI2NvbXBvbmVudFwiKS5odG1sKFwiZXJyb3IgZnVuY3Rpb25cIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBSZXR1cm4gdGhlIG1ldGhvZHMgdGhhdCBjYW4gYmUgdXNlZCBieSBvdGhlciBwcm9ncmFtcyAodGhlIGNvbnRyb2xsZXIgaW4gdGhpcyBjYXNlKVxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBHZXRQcm9kdWN0SW5mbzogR2V0UHJvZHVjdEluZm9cclxuICAgIH1cclxufTsiLCJ2YXIgRXJyb3JDb250cm9sbGVyID0gZnVuY3Rpb24odmlld0hlbHBlcilcclxue1xyXG4gICAgdmFyIFZpZXdIZWxwZXIgPSB2aWV3SGVscGVyO1xyXG5cclxuICAgIC8vIE1haW4gZnVuY3Rpb24sIGFsc28gdGhlIHN0YXJ0IHN0YXJ0cG9pbnQgZm9yIGEgcGFnZVxyXG4gICAgZnVuY3Rpb24gbWFpbigpXHJcbiAgICB7XHJcbiAgICAgICAgLy8gc2V0IHZpZXcgdG8gbG9naW4gZm9ybVxyXG4gICAgICAgIFZpZXdIZWxwZXIuc2V0VmlldygpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFJldHVybiB0aGUgbWV0aG9kcyB0aGF0IGNhbiBiZSB1c2VkIGJ5IG90aGVyIHByb2dyYW1zICh0aGUgY29udHJvbGxlciBpbiB0aGlzIGNhc2UpXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIG1haW46IG1haW5cclxuICAgIH1cclxufTsiLCJ2YXIgTG9naW5Db250cm9sbGVyID0gZnVuY3Rpb24odmlld0hlbHBlciwgbW9kZWwpXHJcbntcclxuICAgIHZhciBNb2RlbCAgICAgID0gbW9kZWw7XHJcbiAgICB2YXIgVmlld0hlbHBlciA9IHZpZXdIZWxwZXI7XHJcbiAgICBcclxuICAgIC8vIEZ1bmN0aW9uIHRoYXQgaXMgZXhlY3V0ZWQgb24gYSBhY3Rpb24gbGlzdGVuZXJcclxuICAgIGZ1bmN0aW9uIGFjdGlvblBlcmZvcm1lZChldmVudClcclxuICAgIHtcclxuICAgICAgICAvLyBQcmV2ZW50IHNlbmRpbmcgdGhlIGZvcm1cclxuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgICAgICAvLyBMb29wIHRyb3VnaCB0aGUgZm9ybSBkYXRhIGFuZCBnZXQgYWxsIGZpZWxkc1xyXG4gICAgICAgIHZhciBmb3JtRGF0YSA9IHt9O1xyXG4gICAgICAgICQuZWFjaCgkKHRoaXMpLnNlcmlhbGl6ZUFycmF5KCksIGZ1bmN0aW9uIChpLCBmaWVsZCkge1xyXG4gICAgICAgICAgICBmb3JtRGF0YVtmaWVsZC5uYW1lXSA9IGZpZWxkLnZhbHVlO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvLyBsZXQgbW9kZWwgc2VuZCBlbWFpbCBhbmQgcGFzc3dvcmQgdG8gQVBJXHJcbiAgICAgICAgTW9kZWwubG9naW4oZm9ybURhdGEuZW1haWwsIGZvcm1EYXRhLnBhc3N3b3JkLCBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAvLyBzaG93IHVpdGxvZ2dlbiBidXR0b25cclxuICAgICAgICAgICAgJChcIiNpbmxvZ2dlbl90ZXh0XCIpLmhpZGUoKTtcclxuICAgICAgICAgICAgJChcIiN1aXRsb2dnZW5fdGV4dFwiKS5zaG93KCk7XHJcblxyXG4gICAgICAgICAgICAvLyBXZWVyZ2VlZiBlZW4gYW5kZXJlIHBhZ2luYSBnZWJhc3NlZXJkIG9wICdhZG1pbicgb2YgJ3JlZ2lzdGVyZWQgdXNlcidcclxuICAgICAgICAgICAgbmV3IFBhZ2VDb250cm9sbGVyKG5ldyBQYWdlVmlld0hlbHBlcigpLCBuZXcgUGFnZU1vZGVsKCkpLm1haW4oKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBNYWluIGZ1bmN0aW9uLCBhbHNvIHRoZSBzdGFydCBzdGFydHBvaW50IGZvciBhIHBhZ2VcclxuICAgIGZ1bmN0aW9uIG1haW4oKVxyXG4gICAge1xyXG4gICAgICAgIC8vIHNldCB2aWV3IHRvIGxvZ2luIGZvcm1cclxuICAgICAgICBWaWV3SGVscGVyLnNldFZpZXcoKTtcclxuXHJcbiAgICAgICAgLy8gdXNlciBmaWxscyBpbiBlbWFpbCBhbmQgcGFzc3dvcmQ7IGNsaWNrcyAnbG9naW4nOiBWSUVXIG5vdGljZXMgdGhpcyBhbmQgcmVhY3RzXHJcbiAgICAgICAgVmlld0hlbHBlci5zZXRBY3Rpb25MaXN0ZW5lcihhY3Rpb25QZXJmb3JtZWQpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFJldHVybiB0aGUgbWV0aG9kcyB0aGF0IGNhbiBiZSB1c2VkIGJ5IG90aGVyIHByb2dyYW1zICh0aGUgY29udHJvbGxlciBpbiB0aGlzIGNhc2UpXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIG1haW46IG1haW5cclxuICAgIH1cclxufTsiLCJ2YXIgTG9nb3V0Q29udHJvbGxlciA9IGZ1bmN0aW9uKHZpZXdIZWxwZXIsIG1vZGVsKVxyXG57XHJcbiAgICB2YXIgTW9kZWwgICAgICA9IG1vZGVsO1xyXG4gICAgdmFyIFZpZXdIZWxwZXIgPSB2aWV3SGVscGVyO1xyXG4gICAgXHJcbiAgICAvLyBGdW5jdGlvbiB0aGF0IGlzIGV4ZWN1dGVkIG9uIGEgYWN0aW9uIGxpc3RlbmVyXHJcbiAgICBmdW5jdGlvbiBhY3Rpb25QZXJmb3JtZWQoZXZlbnQpXHJcbiAgICB7XHJcbiAgICAgICAgTW9kZWwubG9nb3V0KGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgIC8vIHNob3cgdWl0bG9nZ2VuIGJ1dHRvblxyXG4gICAgICAgICAgICAkKFwiI2lubG9nZ2VuX3RleHRcIikuc2hvdygpO1xyXG4gICAgICAgICAgICAkKFwiI3VpdGxvZ2dlbl90ZXh0XCIpLmhpZGUoKTtcclxuXHJcbiAgICAgICAgICAgIC8vIHNldCB2aWV3IHRvIGxvZ2luIGZvcm1cclxuICAgICAgICAgICAgVmlld0hlbHBlci5zZXRWaWV3KCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gTWFpbiBmdW5jdGlvbiwgYWxzbyB0aGUgc3RhcnQgc3RhcnRwb2ludCBmb3IgYSBwYWdlXHJcbiAgICBmdW5jdGlvbiBtYWluKClcclxuICAgIHtcclxuICAgICAgICAvLyB1c2VyIGZpbGxzIGluIGVtYWlsIGFuZCBwYXNzd29yZDsgY2xpY2tzICdsb2dpbic6IFZJRVcgbm90aWNlcyB0aGlzIGFuZCByZWFjdHNcclxuICAgICAgICBWaWV3SGVscGVyLnNldEFjdGlvbkxpc3RlbmVyKGFjdGlvblBlcmZvcm1lZCk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gUmV0dXJuIHRoZSBtZXRob2RzIHRoYXQgY2FuIGJlIHVzZWQgYnkgb3RoZXIgcHJvZ3JhbXMgKHRoZSBjb250cm9sbGVyIGluIHRoaXMgY2FzZSlcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgbWFpbjogbWFpblxyXG4gICAgfVxyXG59OyIsInZhciBQYWdlQ29udHJvbGxlciA9IGZ1bmN0aW9uKHZpZXdIZWxwZXIsIG1vZGVsKVxyXG57XHJcbiAgICB2YXIgTW9kZWwgPSBtb2RlbDtcclxuICAgIHZhciBWaWV3ICA9IHZpZXdIZWxwZXI7XHJcbiAgICBcclxuICAgIC8vIEZ1bmN0aW9uIHRoYXQgaXMgZXhlY3V0ZWQgb24gYSBhY3Rpb24gbGlzdGVuZXJcclxuICAgIGZ1bmN0aW9uIGFjdGlvblBlcmZvcm1lZChldmVudClcclxuICAgIHtcclxuICAgICAgICBNb2RlbC5nZXRQYWdlKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgIFZpZXcuc2V0VmlldyhkYXRhKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBNYWluIGZ1bmN0aW9uLCBhbHNvIHRoZSBzdGFydCBzdGFydHBvaW50IGZvciBhIHBhZ2VcclxuICAgIGZ1bmN0aW9uIG1haW4oKVxyXG4gICAgeyAgICAgICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgIFZpZXcuc2V0QWN0aW9uTGlzdGVuZXIoYWN0aW9uUGVyZm9ybWVkKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBSZXR1cm4gdGhlIG1ldGhvZHMgdGhhdCBjYW4gYmUgdXNlZCBieSBvdGhlciBwcm9ncmFtcyAodGhlIGNvbnRyb2xsZXIgaW4gdGhpcyBjYXNlKVxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBtYWluOiBtYWluXHJcbiAgICB9XHJcbn07IiwidmFyIFByb2R1Y3RzQ29udHJvbGxlciA9IGZ1bmN0aW9uKHZpZXdIZWxwZXIsIG1vZGVsKVxyXG57XHJcbiAgICB2YXIgTW9kZWwgICAgICA9IG1vZGVsO1xyXG4gICAgdmFyIFZpZXdIZWxwZXIgPSB2aWV3SGVscGVyO1xyXG4gICAgXHJcbiAgICAvLyBGdW5jdGlvbiB0aGF0IGlzIGV4ZWN1dGVkIG9uIGEgYWN0aW9uIGxpc3RlbmVyXHJcbiAgICBmdW5jdGlvbiBnZXRQYWdlKClcclxuICAgIHtcclxuICAgICAgICBNb2RlbC5nZXRQYWdlKFwiXCIsIGZ1bmN0aW9uIChkYXRhKSB7IFZpZXdIZWxwZXIuc2V0VmlldyhkYXRhKTsgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gZmlsdGVyUHJvZHVjdHMoZXZlbnQpXHJcbiAgICB7XHJcbiAgICAgICAgLy8gUHJldmVudCBzZW5kaW5nIHRoZSBmb3JtIChwYWdlIHJlbG9hZClcclxuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgICAgICB2YXIgZmlsdGVycyA9ICQodGhpcykuc2VyaWFsaXplKCk7XHJcbiAgICAgICAgTW9kZWwuZ2V0UGFnZShmaWx0ZXJzLCBmdW5jdGlvbiAoZGF0YSkgeyBWaWV3SGVscGVyLmxvYWRQcm9kdWN0cyhkYXRhKTsgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gTWFpbiBmdW5jdGlvbiwgYWxzbyB0aGUgc3RhcnQgc3RhcnRwb2ludCBmb3IgYSBwYWdlXHJcbiAgICBmdW5jdGlvbiBtYWluKClcclxuICAgIHsgICAgICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICBWaWV3SGVscGVyLnNldEFjdGlvbkxpc3RlbmVyKGdldFBhZ2UpO1xyXG4gICAgICAgIFZpZXdIZWxwZXIuc2V0RmlsdGVyTGlzdGVuZXIoZmlsdGVyUHJvZHVjdHMpO1xyXG4gICAgICAgIC8vIG5ldyBhY3Rpb24gd2FubmVyIGVyIG9wIGZpbHRlciB3b3JkdCBnZWRydWt0XHJcbiAgICB9XHJcblxyXG4gICAgLy8gUmV0dXJuIHRoZSBtZXRob2RzIHRoYXQgY2FuIGJlIHVzZWQgYnkgb3RoZXIgcHJvZ3JhbXMgKHRoZSBjb250cm9sbGVyIGluIHRoaXMgY2FzZSlcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgbWFpbjogbWFpblxyXG4gICAgfVxyXG59OyIsInZhciBSZWdpc3RlckNvbnRyb2xsZXIgPSBmdW5jdGlvbih2aWV3SGVscGVyLCBtb2RlbClcclxue1xyXG4gICAgdmFyIE1vZGVsICAgICAgPSBtb2RlbDtcclxuICAgIHZhciBWaWV3SGVscGVyID0gdmlld0hlbHBlcjtcclxuICAgIFxyXG4gICAgLy8gRnVuY3Rpb24gdGhhdCBpcyBleGVjdXRlZCBvbiBhIGFjdGlvbiBsaXN0ZW5lclxyXG4gICAgZnVuY3Rpb24gYWN0aW9uUGVyZm9ybWVkKClcclxuICAgIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhcImluIGFjdGlvblBlcmZvcm1lZFwiKTsgLy90ZXN0XHJcblxyXG4gICAgICAgIC8vIFByZXZlbnQgc2VuZGluZyB0aGUgZm9ybVxyXG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gICAgICAgIC8vIHJlc2V0IGVycm9yIG1lc3NhZ2VzXHJcbiAgICAgICAgJChcIiNyZWdpX2FwaV9lcnJvcl9tZXNzYWdlXCIpLmhpZGUoKTtcclxuICAgICAgICAkKFwiI3d3Ml9lcnJvcl9tZXNzYWdlXCIpLmhpZGUoKTtcclxuXHJcbiAgICAgICAgLy8gcHV0IGZvcm0gZmllbGRzIGluIGphdmFzY3JpcHQgT2JqZWN0XHJcbiAgICAgICAgdmFyIGZvcm1EYXRhID0ge307XHJcblxyXG4gICAgICAgICQuZWFjaCgkKHRoaXMpLnNlcmlhbGl6ZUFycmF5KCksIGZ1bmN0aW9uIChpLCBmaWVsZCkge1xyXG4gICAgICAgICAgICBmb3JtRGF0YVtmaWVsZC5uYW1lXSA9IGZpZWxkLnZhbHVlO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvLyBmaXggZGF0ZSBvZiBiaXJ0aCAoQVBJIGV4cGVjdHMgY2VydGFpbiBmb3JtYXQpXHJcbiAgICAgICAgZm9ybURhdGFbXCJiaXJ0aF9kYXRlXCJdID0gZm9ybURhdGEuamFhciArIFwiLVwiICsgZm9ybURhdGEubWFhbmQgKyBcIi1cIiArIGZvcm1EYXRhLmRhZztcclxuXHJcbiAgICAgICAgLy8gY2hlY2sgd2hldGhlciBhbnkgbWFuZGF0b3J5IGZpZWxkIGlzIGxlZnQgZW1wdHkgYnkgdXNlciBhbmRcclxuICAgICAgICAvLyBpZiBzbywgYWJvcnQgZnVuY3Rpb25cclxuICAgICAgICB2YXIgbWFuZGF0b3J5RmllbGRNaXNzZXMgPSBmYWxzZTtcclxuICAgICAgICB2YXIgbWFuZGF0b3J5RmllbGRzID0gW1widm9vcm5hYW1cIiwgXCJhY2h0ZXJuYWFtXCIsIFwicG9zdGNvZGVcIiwgXCJodWlzbnVtbWVyXCIsIFwiZV9tYWlsYWRyZXNcIiwgXCJ3YWNodHdvb3JkXCIsIFwid2FjaHR3b29yZDJcIiwgXCJzZWN1cml0eV9hbnN3ZXJcIl07IC8vZHJvcGRvd25zIChsaWtlIGdlbmRlcikgYXJlIGFsd2F5cyBmaWxsZWQgaW4sIHNvIGRvbid0IHB1dCBpbiB0aGlzIGxpc3RcclxuXHJcbiAgICAgICAgLy8gKHJlc2V0IGFsbCBmaWVsZHMgdG8gJ3ZhbGlkJyBiZWNhdXNlIHVzZXIgbWF5IGhhdmUgZmlsbGVkIGluIGZpZWxkcyBzaW5jZVxyXG4gICAgICAgIC8vIHRoZSBwcmV2aW91cyB0aW1lIHRoaXMgZnVuY3Rpb24gd2FzIGNhbGxlZClcclxuICAgICAgICAkLmVhY2gobWFuZGF0b3J5RmllbGRzLCBmdW5jdGlvbiAoaSwgbWFuRmllbGQpIHtcclxuICAgICAgICAgICAgJChcIiNcIiArIG1hbkZpZWxkKS5yZW1vdmVDbGFzcyhcImludmFsaWRcIik7XHJcbiAgICAgICAgfSlcclxuXHJcbiAgICAgICAgJC5lYWNoKG1hbmRhdG9yeUZpZWxkcywgZnVuY3Rpb24gKGksIG1hbkZpZWxkKSB7XHJcbiAgICAgICAgICAgIGlmIChmb3JtRGF0YVttYW5GaWVsZF0gPT0gXCJcIilcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgJChcIiNcIiArIG1hbkZpZWxkKS5hZGRDbGFzcyhcImludmFsaWRcIik7XHJcblxyXG4gICAgICAgICAgICAgICAgbWFuZGF0b3J5RmllbGRNaXNzZXMgPSB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuXHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gaWYgYSBtYW5kYXRvcnkgZmllbGQgaXMgZW1wdHksIHNob3cgZXJyb3IgbWVzc2FnZSB0byB1c2VyIGFuZCBhYm9ydCBmdW5jdGlvblxyXG4gICAgICAgIGlmIChtYW5kYXRvcnlGaWVsZE1pc3NlcylcclxuICAgICAgICB7IFxyXG4gICAgICAgICAgICAvLyBzY3JvbGwgdG8gdG9wIG9mIHBhZ2Ugc28gdGhhdCB1c2VycyBzZWUgbWVzc2FnZSBcInNvbWV0aGluZyBpcyBub3QgZmlsbGVkIGluXCJcclxuICAgICAgICAgICAgd2luZG93LnNjcm9sbFRvKDAsIDApO1xyXG4gICAgICAgICAgICAvLyBzaG93IG1lc3NhZ2UgXCJzb21ldGhpbmcgaXMgbm90IGZpbGxlZCBpblwiXHJcbiAgICAgICAgICAgICQoXCIjcmVnaXN0ZXJfZXJyb3JfbWVzc2FnZVwiKS5zaG93KCk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIHBhc3N3b3Jkc05vdElkZW50aWNhbCA9IGZhbHNlO1xyXG5cclxuICAgICAgICBpZiAoZm9ybURhdGEud2FjaHR3b29yZCAhPSBmb3JtRGF0YS53YWNodHdvb3JkMikgXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBwYXNzd29yZHNOb3RJZGVudGljYWwgPSB0cnVlO1xyXG4gICAgICAgICAgICAkKFwiI3d3Ml9lcnJvcl9tZXNzYWdlXCIpLnNob3coKTtcclxuICAgICAgICAgICAgJChcIiN3YWNodHdvb3JkXCIpLmFkZENsYXNzKFwiaW52YWxpZFwiKTtcclxuICAgICAgICAgICAgJChcIiN3YWNodHdvb3JkMlwiKS5hZGRDbGFzcyhcImludmFsaWRcIik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBhYm9ydCBmdW5jdGlvbiBpZiBtYW5kYXRvcnkgZmllbGQgbWlzc2VzIG9yIHBhc3N3b3JkcyBub3QgaWRlbnRpY2FsXHJcbiAgICAgICAgaWYgKG1hbmRhdG9yeUZpZWxkTWlzc2VzIHx8IHBhc3N3b3Jkc05vdElkZW50aWNhbClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnNvbGUubG9nKFwiZnVuY3Rpb24gbm90IGFib3J0ZWRcIik7IC8vdGVzdFxyXG5cclxuICAgICAgICBjb25zb2xlLmxvZyhmb3JtRGF0YSk7XHJcbiAgICAgICAgLy8gbGV0IG1vZGVsIHNlbmQgdXNlciBpbmZvIHRvIEFQSVxyXG4gICAgICAgIE1vZGVsLnJlZ2lzdGVyKGZvcm1EYXRhLCBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICBcclxuXHJcbiAgICAgICAgICAgIC8vIFdlZXJnZWVmIGVlbiBhbmRlcmUgcGFnaW5hIGFscyByZWdpc3RyYXRpZSBwcm9jZXMgY29ycmVjdCB1aXRnZXZvZXJkXHJcbiAgICAgICAgICAgIFZpZXdIZWxwZXIuc2V0Vmlldygndmlld3MvcmVnaXN0ZXIvYWZ0ZXJfcmVnaXN0ZXIuaHRtbCcpO1xyXG5cclxuICAgICAgICAgICAgLy8gZ2VsaWprIGlubG9nZ2VuIGFscyBuaWV1d2UgdXNlciB6aWNoIGdlcmVnaXN0cmVlcmQgaGVlZnQ/XHJcbiAgICAgICAgICAgIC8vJChcIiNpbmxvZ2dlbl90ZXh0XCIpLmhpZGUoKTtcclxuICAgICAgICAgICAgLy8kKFwiI3VpdGxvZ2dlbl90ZXh0XCIpLnNob3coKTtcclxuXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgXHJcbi8qXHJcbiAgICAgICAgJChcIiNpbmxvZ2dlbl90ZXh0XCIpLmhpZGUoKTtcclxuICAgICAgICAkKFwiI3VpdGxvZ2dlbl90ZXh0XCIpLnNob3coKTtcclxuICAgICAgICBWaWV3SGVscGVyLnNldFZpZXcoJ3ZpZXdzL3JlZ2lzdGVyL2FmdGVyX3JlZ2lzdGVyLmh0bWwnKTtcclxuKi9cclxuICAgICAgICAvL01vZGVsLmdldFBhZ2UoZnVuY3Rpb24gKGRhdGEpIHsgVmlld0hlbHBlci5zZXRWaWV3KGRhdGEpOyB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBNYWluIGZ1bmN0aW9uLCBhbHNvIHRoZSBzdGFydCBzdGFydHBvaW50IGZvciBhIHBhZ2VcclxuICAgIGZ1bmN0aW9uIG1haW4oKVxyXG4gICAge1xyXG4gICAgICAgIC8vIHNldCB2aWV3IHRvIHJlZ2lzdGVyIGZvcm1cclxuICAgICAgICBWaWV3SGVscGVyLnNldFZpZXcoJ3ZpZXdzL3JlZ2lzdGVyL3JlZ2lzdGVyLmh0bWwnKTtcclxuXHJcbiAgICAgICAgLy8gdXNlciBmaWxscyBpbiByZWdpc3RlciBpbmZvOyBjbGlja3MgJ3JlZ2lzdGVyJzogdmlldyBub3RpY2VzIHRoaXMgYW5kIHJlYWN0c1xyXG4gICAgICAgIFZpZXdIZWxwZXIuc2V0QWN0aW9uTGlzdGVuZXIoYWN0aW9uUGVyZm9ybWVkKTtcclxuXHJcbiAgICAgICAgLy8gZW1haWwgYW5kIHBhc3N3b3JkIGFyZSBzZW5kIHRvIEFQSTsgQVBJIGNoZWNrcyBpZiBlbWFpbCBhbHJlYWR5IGV4aXN0cyAoYW5kIHdoZXRoZXIgcGFzc3dvcmQgaXMgY29ycmVjdD8pIFxyXG5cclxuXHJcbiAgICB9XHJcblxyXG4gICAgLy8gUmV0dXJuIHRoZSBtZXRob2RzIHRoYXQgY2FuIGJlIHVzZWQgYnkgb3RoZXIgcHJvZ3JhbXMgKHRoZSBjb250cm9sbGVyIGluIHRoaXMgY2FzZSlcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgbWFpbjogbWFpblxyXG4gICAgfVxyXG59OyIsInZhciBQcm9kdWN0Q29udHJvbGxlciA9IGZ1bmN0aW9uKHZpZXdIZWxwZXIsIG1vZGVsKVxyXG57XHJcbiAgICB2YXIgTW9kZWwgICAgICA9IG1vZGVsO1xyXG4gICAgdmFyIFZpZXdIZWxwZXIgPSB2aWV3SGVscGVyO1xyXG4gICAgXHJcbiAgICAvLyBGdW5jdGlvbiB0aGF0IGlzIGV4ZWN1dGVkIG9uIGEgYWN0aW9uIGxpc3RlbmVyXHJcbiAgICBmdW5jdGlvbiBhY3Rpb25QZXJmb3JtZWQoZXZlbnQpXHJcbiAgICB7XHJcbiAgICAgICAgLy8gUHJldmVudCBzZW5kaW5nIHRoZSBmb3JtXHJcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuICAgICAgICAvLyBMb29wIHRyb3VnaCB0aGUgZm9ybSBkYXRhIGFuZCBnZXQgYWxsIGZpZWxkc1xyXG4gICAgICAgIHZhciBmb3JtRGF0YSA9IHt9O1xyXG4gICAgICAgICQuZWFjaCgkKHRoaXMpLnNlcmlhbGl6ZUFycmF5KCksIGZ1bmN0aW9uIChpLCBmaWVsZCkge1xyXG4gICAgICAgICAgICBmb3JtRGF0YVtmaWVsZC5uYW1lXSA9IGZpZWxkLnZhbHVlO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvLyBsZXQgbW9kZWwgc2VuZCBlbWFpbCBhbmQgcGFzc3dvcmQgdG8gQVBJXHJcbiAgICAgICAgTW9kZWwubG9naW4oZm9ybURhdGEuZW1haWwsIGZvcm1EYXRhLnBhc3N3b3JkLCBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAvLyBzaG93IHVpdGxvZ2dlbiBidXR0b25cclxuICAgICAgICAgICAgJChcIiNpbmxvZ2dlbl90ZXh0XCIpLmhpZGUoKTtcclxuICAgICAgICAgICAgJChcIiN1aXRsb2dnZW5fdGV4dFwiKS5zaG93KCk7XHJcblxyXG4gICAgICAgICAgICAvLyBXZWVyZ2VlZiBlZW4gYW5kZXJlIHBhZ2luYSBnZWJhc3NlZXJkIG9wICdhZG1pbicgb2YgJ3JlZ2lzdGVyZWQgdXNlcidcclxuICAgICAgICAgICAgbmV3IFBhZ2VDb250cm9sbGVyKG5ldyBQYWdlVmlld0hlbHBlcigpLCBuZXcgUGFnZU1vZGVsKCkpLm1haW4oKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBsZXQgdmlldyBzaG93IHZpZXcgd2l0aCBkYXRhIGZyb20gZGF0YWJhc2VcclxuICAgIGZ1bmN0aW9uIHNob3dWaWV3KGRhdGEpXHJcbiAgICB7XHJcbiAgICAgICAgdmlld0hlbHBlci5zZXRWaWV3KGRhdGEpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIE1haW4gZnVuY3Rpb24sIGFsc28gdGhlIHN0YXJ0IHN0YXJ0cG9pbnQgZm9yIGEgcGFnZVxyXG4gICAgZnVuY3Rpb24gbWFpbigpXHJcbiAgICB7XHJcbiAgICAgICAgLy8gd2hhdCBoYXBwZW5zOlxyXG4gICAgICAgIC8vIDEpIHVzZXIgY2xpY2tzIG9uIGEgcHJvZHVjdCBcclxuICAgICAgICAvLyAyKSBtb2RlbCBnZXRzIGluZm8gb2YgdGhlIHByb2R1Y3RcclxuICAgICAgICAvLyAzKSBzeXN0ZW0gcHV0cyBpbmZvIGluIGh0bWxcclxuICAgICAgICAvLyA0KSB2aWV3IHNob3dzIGluZm9cclxuXHJcbiAgICAgICAgLy8gMikgbW9kZWwgZ2V0cyBpbmZvIG9mIHRoZSBwcm9kdWN0XHJcbiAgICAgICAgLy8gMykgc3lzdGVtIHB1dHMgaW5mbyBpbiBodG1sXHJcbiAgICAgICAgbW9kZWwuR2V0UHJvZHVjdEluZm8oc2hvd1ZpZXcpO1xyXG5cclxuXHJcblxyXG4gICAgICAgIC8vIHNldCB2aWV3IHRvIGxvZ2luIGZvcm1cclxuICAgICAgICAvL1ZpZXdIZWxwZXIuc2V0VmlldygpO1xyXG5cclxuICAgICAgICAvLyB1c2VyIGZpbGxzIGluIGVtYWlsIGFuZCBwYXNzd29yZDsgY2xpY2tzICdsb2dpbic6IFZJRVcgbm90aWNlcyB0aGlzIGFuZCByZWFjdHNcclxuICAgICAgICAvL1ZpZXdIZWxwZXIuc2V0QWN0aW9uTGlzdGVuZXIoYWN0aW9uUGVyZm9ybWVkKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBSZXR1cm4gdGhlIG1ldGhvZHMgdGhhdCBjYW4gYmUgdXNlZCBieSBvdGhlciBwcm9ncmFtcyAodGhlIGNvbnRyb2xsZXIgaW4gdGhpcyBjYXNlKVxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBtYWluOiBtYWluLFxyXG4gICAgICAgIHNob3dWaWV3IDogc2hvd1ZpZXdcclxuICAgIH1cclxufTsiLCJ2YXIgRXJyb3JWaWV3SGVscGVyID0gZnVuY3Rpb24oKVxyXG57XHJcbiAgICAvLyBDaGFuZ2UgdGhlIHZpZXcgb2YgdGhlIHBhZ2VcclxuICAgIGZ1bmN0aW9uIHNldFZpZXcoKVxyXG4gICAge1xyXG4gICAgICAgICQoXCIjY29tcG9uZW50XCIpLmxvYWQoJ3ZpZXdzL2Vycm9yL2Vycm9yLmh0bWwnKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBBY3Rpb25MaXN0ZW5lciB0aGF0IGV4ZWN1dGVzIGFjdGlvbnMgb24gc3BlY2lmaWMgZXZlbnRzXHJcbiAgICBmdW5jdGlvbiBzZXRBY3Rpb25MaXN0ZW5lcihldmVudEhhbmRsZXIpXHJcbiAgICB7XHJcbiAgICAgICAgJChkb2N1bWVudCkucmVhZHkoZXZlbnRIYW5kbGVyKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBSZXR1cm4gdGhlIG1ldGhvZHMgdGhhdCBjYW4gYmUgdXNlZCBieSBvdGhlciBwcm9ncmFtcyAodGhlIGNvbnRyb2xsZXIgaW4gdGhpcyBjYXNlKVxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBzZXRWaWV3OiBzZXRWaWV3LFxyXG4gICAgICAgIHNldEFjdGlvbkxpc3RlbmVyOiBzZXRBY3Rpb25MaXN0ZW5lclxyXG4gICAgfVxyXG59OyIsInZhciBMb2dpblZpZXdIZWxwZXIgPSBmdW5jdGlvbigpXHJcbntcclxuICAgIC8vIENoYW5nZSB0aGUgdmlldyBvZiB0aGUgcGFnZVxyXG4gICAgZnVuY3Rpb24gc2V0VmlldygpXHJcbiAgICB7XHJcbiAgICAgICAgJChcIiNjb21wb25lbnRcIikubG9hZCgndmlld3MvbG9naW4vbG9naW4uaHRtbCcpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEV4ZWN1dGUgdGhlIGV2ZW50IHdoZW4gJ3NvbWV0aGluZycgaGFwcGVucyAod2hlbiBhIGJ1dHRvbiBpcyBjbGlja2VkIGZvciBleGFtcGxlKVxyXG4gICAgZnVuY3Rpb24gc2V0QWN0aW9uTGlzdGVuZXIoYWN0aW9uKVxyXG4gICAge1xyXG4gICAgICAgIC8vIHVzZXIgZmlsbHMgaW4gbG9naW4gZm9ybVxyXG4gICAgICAgIC8vIHVzZXIgcHJlc3NlcyAnbG9naW4nXHJcblxyXG4gICAgICAgIC8vIGlmIHVzZXIgcHJlc3NlcyAnbG9naW4nLCBwZXJmb3JtIGFjdGlvbiAobWFrZSBjb250cm9sbGVyIHNlbmQgZW1haWwgYW5kIHBhc3N3b3JkIHRvIEFQSSlcclxuICAgICAgICAkKFwiI2NvbXBvbmVudFwiKS5vbihcInN1Ym1pdFwiLCBcIiNsb2dpbmZvcm1cIiwgYWN0aW9uKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBSZXR1cm4gdGhlIG1ldGhvZHMgdGhhdCBjYW4gYmUgdXNlZCBieSBvdGhlciBwcm9ncmFtcyAodGhlIGNvbnRyb2xsZXIgaW4gdGhpcyBjYXNlKVxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBzZXRWaWV3OiBzZXRWaWV3LFxyXG4gICAgICAgIHNldEFjdGlvbkxpc3RlbmVyOiBzZXRBY3Rpb25MaXN0ZW5lclxyXG4gICAgfVxyXG59OyIsInZhciBMb2dvdXRWaWV3SGVscGVyID0gZnVuY3Rpb24oKVxyXG57XHJcbiAgICAvLyBDaGFuZ2UgdGhlIHZpZXcgb2YgdGhlIHBhZ2VcclxuICAgIGZ1bmN0aW9uIHNldFZpZXcoKVxyXG4gICAge1xyXG4gICAgICAgICQoXCIjY29tcG9uZW50XCIpLmxvYWQoJ3ZpZXdzL2xvZ291dC9sb2dvdXQuaHRtbCcpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEV4ZWN1dGUgdGhlIGV2ZW50IHdoZW4gJ3NvbWV0aGluZycgaGFwcGVucyAod2hlbiBhIGJ1dHRvbiBpcyBjbGlja2VkIGZvciBleGFtcGxlKVxyXG4gICAgZnVuY3Rpb24gc2V0QWN0aW9uTGlzdGVuZXIoYWN0aW9uKVxyXG4gICAge1xyXG4gICAgICAgICQoZG9jdW1lbnQpLnJlYWR5KGFjdGlvbik7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gUmV0dXJuIHRoZSBtZXRob2RzIHRoYXQgY2FuIGJlIHVzZWQgYnkgb3RoZXIgcHJvZ3JhbXMgKHRoZSBjb250cm9sbGVyIGluIHRoaXMgY2FzZSlcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgc2V0Vmlldzogc2V0VmlldyxcclxuICAgICAgICBzZXRBY3Rpb25MaXN0ZW5lcjogc2V0QWN0aW9uTGlzdGVuZXJcclxuICAgIH1cclxufTsiLCJ2YXIgUHJvZHVjdHNWaWV3SGVscGVyID0gZnVuY3Rpb24oKVxyXG57XHJcbiAgICAvLyBDaGFuZ2UgdGhlIHZpZXcgb2YgdGhlIHBhZ2VcclxuICAgIGZ1bmN0aW9uIHNldFZpZXcodmlld0RhdGEpXHJcbiAgICB7XHJcbiAgICAgICAgJChcIiNjb21wb25lbnRcIikuaHRtbCgnPGRpdiBjbGFzcz1cImNvbC0xMlwiPjxkaXYgY2xhc3M9XCJjb2wtM1wiIGlkPVwiZmlsdGVyc1wiPjwvZGl2PjxkaXYgY2xhc3M9XCJjb2wtOVwiIGlkPVwicHJvZHVjdHNcIj48L2Rpdj48L2Rpdj4nKTtcclxuICAgICAgICAvLyBsb2FkIGZpbHRlcnNcclxuICAgICAgICAkKFwiI2ZpbHRlcnNcIikubG9hZCgndmlld3MvcHJvZHVjdHMvZmlsdGVycy5odG1sJyk7XHJcblxyXG4gICAgICAgIC8vIGxvYWQgcHJvZHVjdHNcclxuICAgICAgICBsb2FkUHJvZHVjdHModmlld0RhdGEpO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGxvYWRQcm9kdWN0cyh2aWV3RGF0YSlcclxuICAgIHtcclxuICAgICAgICAkKFwiI3Byb2R1Y3RzXCIpLmxvYWQoJ3ZpZXdzL3Byb2R1Y3RzL3Byb2R1Y3RzLmh0bWwnLCBmdW5jdGlvbiAoKSB7IC8vIHdhYXIgaWQgPSAnY29tcG9uZW50JyBkb2UgLmxvYWQuLi4uLi5cclxuICAgICAgICAgICAgJC5lYWNoKHZpZXdEYXRhLCBmdW5jdGlvbihrZXksIHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBDbG9uZSBwcm9kdWN0XHJcbiAgICAgICAgICAgICAgICB2YXIgcHJvZHVjdCA9ICQoJzxkaXY+JykuYXBwZW5kKCQoJyNwcm9kdWN0X19saXN0X19pdGVtJykuY2xvbmUoKSk7XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIC8vIEFkZCBwcm9kdWN0IGluZm9cclxuICAgICAgICAgICAgICAgICQocHJvZHVjdCkuZmluZChcIi5wcm9kdWN0X190aXRsZVwiKS5odG1sKHZhbHVlLnRpdGxlKTtcclxuICAgICAgICAgICAgICAgICQocHJvZHVjdCkuZmluZChcIi5wcm9kdWN0X19zdWJ0aXRsZVwiKS5hcHBlbmQodmFsdWUuZ2VucmUgKyhcIiB8IFwiKSsgdmFsdWUucGVnaV9hZ2UgKyhcIiB8IFwiKSsgUGxhdGZvcm1Mb2dvKHZhbHVlLnBsYXRmb3JtKSk7XHJcbiAgICAgICAgICAgICAgICAkKHByb2R1Y3QpLmZpbmQoXCIucHJvZHVjdF9fZGVzY3JpcHRpb25cIikuaHRtbChDdXRTdHJpbmcodmFsdWUuZGVzY3JpcHRpb24pKTtcclxuICAgICAgICAgICAgICAgICQocHJvZHVjdCkuZmluZChcIi5wcm9kdWN0X19wcmljZVwiKS5hcHBlbmQoKFwi4oKsIFwiKSt2YWx1ZS5wcmljZSk7XHJcbiAgICAgICAgICAgICAgICAkKHByb2R1Y3QpLmZpbmQoXCIjYnV0dG9uc19faW5mb1wiKS5hdHRyKFwiaHJlZlwiLCBcInByb2R1Y3QvXCIgKyB2YWx1ZS5lYW5fbnVtYmVyKVxyXG4gICAgICAgICAgICAgICAgJChwcm9kdWN0KS5maW5kKFwiLnByb2R1Y3RfX2ltYWdlIGltZ1wiKS5hdHRyKFwic3JjXCIsIHZhbHVlLmltYWdlKTtcclxuXHJcbiAgICAgICAgICAgICAgICAkKFwiI3Byb2R1Y3RfX2xpc3RcIikuYXBwZW5kKHByb2R1Y3QpO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vIFJlbW92ZSB0aGUgZmlyc3QgbGlzdCBpdGVtLCBiZWNhdXNlIHRoaXMgaXRlbSBpcyBhbHdheXMgZW1wdHlcclxuICAgICAgICAgICAgJChcIiNwcm9kdWN0X19saXN0X19pdGVtXCIpLmZpcnN0KCkucmVtb3ZlKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy9TaG93IG1vcmUvbGVzc1xyXG4gICAgZnVuY3Rpb24gQ3V0U3RyaW5nKHRleHQpe1xyXG4gICAgICAgIHZhciBTaG93QW1vdW50ID0gNTA7XHJcbiAgICAgICAgdmFyIFdvcmRzQXJyYXkgPSB0ZXh0LnNwbGl0KFwiIFwiKTtcclxuICAgICAgICBpZihXb3Jkc0FycmF5Lmxlbmd0aD5TaG93QW1vdW50KXtcclxuICAgICAgICAgICAgdmFyIFNob3J0U3RyaW5nID0gXCJcIjtcclxuICAgICAgICAgICAgZm9yKGk9MDsgaTxTaG93QW1vdW50OyBpKyspe1xyXG4gICAgICAgICAgICAgICAgU2hvcnRTdHJpbmcgKz0gV29yZHNBcnJheVtpXSArIFwiIFwiO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBTaG9ydFN0cmluZytcIi4uLlwiO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICByZXR1cm4gdGV4dDtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIC8vUGxhdGZvcm0gTG9nbydzXHJcbiAgICBmdW5jdGlvbiBQbGF0Zm9ybUxvZ28ocGxhdGZvcm1uYWFtKXtcclxuICAgICAgICBpZiAocGxhdGZvcm1uYWFtLnRvVXBwZXJDYXNlKCkgPT09IFwiUFM0XCIpe1xyXG4gICAgICAgICAgICByZXR1cm4gXCI8aW1nIHNyYz0naHR0cHM6Ly9tYXhjZG4uaWNvbnM4LmNvbS9BbmRyb2lkX0wvUE5HLzQ4L0xvZ29zL3BsYXlfc3RhdGlvbl9jb3B5cmlnaHRlZC00OC5wbmcnIC8+XCI7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBlbHNlIGlmIChwbGF0Zm9ybW5hYW0udG9VcHBlcmNhc2UoKSA9PT0gXCJQQ1wiKXtcclxuICAgICAgICAgICAgcmV0dXJuIFwiPGltZyBzcmM9J2h0dHBzOi8vbWF4Y2RuLmljb25zOC5jb20vQ29sb3IvUE5HLzQ4L09wZXJhdGluZ19TeXN0ZW1zL3dpbmRvd3NfbG9nb19jb3B5cmlnaHRlZC00OC5wbmcnIC8+XCI7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBlbHNlIGlmIChwbGF0Zm9ybW5hYW0udG9VcHBlcmNhc2UoKSA9PT0gXCJYQk9YXCIpe1xyXG4gICAgICAgICAgICByZXR1cm4gXCI8aW1nIHNyYz0naHR0cHM6Ly9tYXhjZG4uaWNvbnM4LmNvbS9Db2xvci9QTkcvNDgvTG9nb3MveGJveC00OC5wbmcnIC8+XCI7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBlbHNle1xyXG4gICAgICAgICAgICByZXR1cm4gcGxhdGZvcm1uYWFtO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBFeGVjdXRlIHRoZSBldmVudCB3aGVuICdzb21ldGhpbmcnIGhhcHBlbnMgKHdoZW4gYSBidXR0b24gaXMgY2xpY2tlZCBmb3IgZXhhbXBsZSlcclxuICAgIGZ1bmN0aW9uIHNldEFjdGlvbkxpc3RlbmVyKGFjdGlvbilcclxuICAgIHtcclxuICAgICAgICAkKGRvY3VtZW50KS5yZWFkeShhY3Rpb24pOyAvLyBpZiAnZG9jdW1lbnQgcmVhZHknIHBlcmZvcm0gXCJhY3Rpb25cIlxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIHNldEZpbHRlckxpc3RlbmVyKGFjdGlvbilcclxuICAgIHtcclxuICAgICAgICAgLy8gSGllciBoZXQgZm9ybXVsaWVyIHZlcnN0dXJlbiBhbHMgd2Ugb3AgZWVuIGNoZWNrYm94IGRydWtrZW5cclxuICAgICAgICAkKFwiI2NvbXBvbmVudFwiKS5vbihcImNoYW5nZVwiLCBcImlucHV0W3R5cGU9Y2hlY2tib3hdXCIsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgICQoXCIjcHJvZHVjdF9maWx0ZXJcIikuc3VibWl0KCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICQoXCIjY29tcG9uZW50XCIpLm9uKFwic3VibWl0XCIsIFwiI3Byb2R1Y3RfZmlsdGVyXCIsIGFjdGlvbik7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gUmV0dXJuIHRoZSBtZXRob2RzIHRoYXQgY2FuIGJlIHVzZWQgYnkgb3RoZXIgcHJvZ3JhbXMgKHRoZSBjb250cm9sbGVyIGluIHRoaXMgY2FzZSlcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgc2V0Vmlldzogc2V0VmlldyxcclxuICAgICAgICBsb2FkUHJvZHVjdHM6IGxvYWRQcm9kdWN0cyxcclxuICAgICAgICBzZXRBY3Rpb25MaXN0ZW5lcjogc2V0QWN0aW9uTGlzdGVuZXIsXHJcbiAgICAgICAgc2V0RmlsdGVyTGlzdGVuZXI6IHNldEZpbHRlckxpc3RlbmVyXHJcbiAgICB9XHJcbn07IiwidmFyIFJlZ2lzdGVyVmlld0hlbHBlciA9IGZ1bmN0aW9uKClcclxue1xyXG4gICAgLy8gQ2hhbmdlIHRoZSB2aWV3IG9mIHRoZSBwYWdlXHJcbiAgICBmdW5jdGlvbiBzZXRWaWV3KHZpZXdUb1Nob3cpXHJcbiAgICB7XHJcbiAgICAgICAgJChcIiNjb21wb25lbnRcIikubG9hZCh2aWV3VG9TaG93KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBFeGVjdXRlIHRoZSBldmVudCB3aGVuICdzb21ldGhpbmcnIGhhcHBlbnMgKHdoZW4gYSBidXR0b24gaXMgY2xpY2tlZCBmb3IgZXhhbXBsZSlcclxuICAgIGZ1bmN0aW9uIHNldEFjdGlvbkxpc3RlbmVyKGFjdGlvbilcclxuICAgIHtcclxuICAgICAgICAvLyB1c2VyIGZpbGxzIGluIHJlZ2lzdGVyIGZvcm1cclxuICAgICAgICAvLyB1c2VyIHByZXNzZXMgJ3JlZ2lzdGVyJ1xyXG5cclxuICAgICAgICAvLyBpZiB1c2VyIHByZXNzZXMgJ3JlZ2lzdGVyJywgcGVyZm9ybSBhY3Rpb25cclxuICAgICAgICAkKFwiI2NvbXBvbmVudFwiKS5vbihcInN1Ym1pdFwiLCBcIiNyZWdpc3RlcmZvcm1cIiwgYWN0aW9uKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBSZXR1cm4gdGhlIG1ldGhvZHMgdGhhdCBjYW4gYmUgdXNlZCBieSBvdGhlciBwcm9ncmFtcyAodGhlIGNvbnRyb2xsZXIgaW4gdGhpcyBjYXNlKVxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBzZXRWaWV3OiBzZXRWaWV3LFxyXG4gICAgICAgIHNldEFjdGlvbkxpc3RlbmVyOiBzZXRBY3Rpb25MaXN0ZW5lclxyXG4gICAgfVxyXG59OyIsInZhciBQYWdlVmlld0hlbHBlciA9IGZ1bmN0aW9uKClcclxue1xyXG4gICAgLy8gQ2hhbmdlIHRoZSB2aWV3IG9mIHRoZSBwYWdlXHJcbiAgICBmdW5jdGlvbiBzZXRWaWV3KHZpZXdEYXRhKVxyXG4gICAge1xyXG4gICAgICAgICQoXCIjY29tcG9uZW50XCIpLmxvYWQoJ3ZpZXdzL3BhZ2UvcGFnZS5odG1sJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAodmlld0RhdGFbMF0udXNlcl90eXBlID09IFwiY3VzdG9tZXJcIilcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgJChcIiN1c2VyLWJsb2NrXCIpLmFwcGVuZChcIjxoMT5KZSBsZWVzIGRpdCBhbGxlZW4gYWxzIGplIGVlbiBjdXN0b21lciBiZW50XCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh2aWV3RGF0YVswXS51c2VyX3R5cGUgPT0gXCJhZG1pblwiKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAkKFwiI3VzZXItYmxvY2tcIikuYXBwZW5kKFwiPGgxPkplIGxlZXMgZGl0IGFsbGVlbiBhbHMgamUgZWVuIGFkbWluaXN0cmF0b3IgYmVudFwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEFjdGlvbkxpc3RlbmVyIHRoYXQgZXhlY3V0ZXMgYWN0aW9ucyBvbiBzcGVjaWZpYyBldmVudHNcclxuICAgIGZ1bmN0aW9uIHNldEFjdGlvbkxpc3RlbmVyKGV2ZW50SGFuZGxlcilcclxuICAgIHtcclxuICAgICAgICAkKGRvY3VtZW50KS5yZWFkeShldmVudEhhbmRsZXIpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFJldHVybiB0aGUgbWV0aG9kcyB0aGF0IGNhbiBiZSB1c2VkIGJ5IG90aGVyIHByb2dyYW1zICh0aGUgY29udHJvbGxlciBpbiB0aGlzIGNhc2UpXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIHNldFZpZXc6IHNldFZpZXcsXHJcbiAgICAgICAgc2V0QWN0aW9uTGlzdGVuZXI6IHNldEFjdGlvbkxpc3RlbmVyXHJcbiAgICB9XHJcbn07IiwidmFyIFByb2R1Y3RWaWV3SGVscGVyID0gZnVuY3Rpb24oKVxyXG57XHJcbiAgICAvLyBDaGFuZ2UgdGhlIHZpZXcgb2YgdGhlIHBhZ2VcclxuICAgIGZ1bmN0aW9uIHNldFZpZXcodmlld0RhdGEpXHJcbiAgICB7XHJcbiAgICAgICAgLy8kKFwiI2NvbXBvbmVudFwiKS5odG1sKCc8ZGl2IGNsYXNzPVwiY29sLTEyXCI+PGRpdiBjbGFzcz1cImNvbC0zXCIgaWQ9XCJmaWx0ZXJzXCI+PC9kaXY+PGRpdiBjbGFzcz1cImNvbC05XCIgaWQ9XCJwcm9kdWN0c1wiPjwvZGl2PjwvZGl2PicpO1xyXG5cclxuICAgICAgICBsb2FkUHJvZHVjdCh2aWV3RGF0YSk7XHJcbiAgICB9XHJcbi8qXHJcbiAgICAvLyBFeGVjdXRlIHRoZSBldmVudCB3aGVuICdzb21ldGhpbmcnIGhhcHBlbnMgKHdoZW4gYSBidXR0b24gaXMgY2xpY2tlZCBmb3IgZXhhbXBsZSlcclxuICAgIGZ1bmN0aW9uIHNldEFjdGlvbkxpc3RlbmVyKGFjdGlvbilcclxuICAgIHtcclxuICAgICAgICAvLyB1c2VyIGZpbGxzIGluIGxvZ2luIGZvcm1cclxuICAgICAgICAvLyB1c2VyIHByZXNzZXMgJ2xvZ2luJ1xyXG5cclxuICAgICAgICAvLyBpZiB1c2VyIHByZXNzZXMgJ2xvZ2luJywgcGVyZm9ybSBhY3Rpb24gKG1ha2UgY29udHJvbGxlciBzZW5kIGVtYWlsIGFuZCBwYXNzd29yZCB0byBBUEkpXHJcbiAgICAgICAgJChcIiNjb21wb25lbnRcIikub24oXCJzdWJtaXRcIiwgXCIjbG9naW5mb3JtXCIsIGFjdGlvbik7XHJcbiAgICB9XHJcbiovXHJcbiAgICBmdW5jdGlvbiBsb2FkUHJvZHVjdChwcm9kdWN0KVxyXG4gICAge1xyXG4gICAgICAgICQoXCIjY29tcG9uZW50XCIpLmxvYWQoJ3ZpZXdzL3NpbmdsZV9wcm9kdWN0L3NpbmdsZV9wcm9kdWN0Lmh0bWwnLCBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgJChcIi5wcm9kdWN0X19pbWFnZSBpbWdcIikuYXR0cihcInNyY1wiLCBwcm9kdWN0LmltYWdlKTtcclxuICAgICAgICAgICAgICAgICQoXCIucHJvZHVjdF9fdGl0bGVcIikuaHRtbChwcm9kdWN0LnRpdGxlKTtcclxuICAgICAgICAgICAgICAgICQoXCIucHJvZHVjdF9fcHJpY2VcIikuaHRtbChcIuKCrCBcIiArIHByb2R1Y3QucHJpY2UpO1xyXG4gICAgICAgICAgICAgICAgLy9saSB2b29yIGxpc3RcclxuICAgICAgICAgICAgICAgICQoXCIubGlwcm9kdWN0X19lYW5cIikuYXBwZW5kKHByb2R1Y3QuZWFuX251bWJlcik7XHJcbiAgICAgICAgICAgICAgICAkKFwiLmxpcHJvZHVjdF9fcGxhdGZvcm1cIikuYXBwZW5kKHByb2R1Y3QucGxhdGZvcm0pO1xyXG4gICAgICAgICAgICAgICAgdmFyIGQgPSBuZXcgRGF0ZShwcm9kdWN0LnJlbGVhc2VfZGF0ZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIG1vbnRocyA9IFtcImphbnVhcmlcIiwgXCJmZWJydWFyaVwiLCBcIm1hYXJ0XCIsIFwiYXByaWxcIiwgXCJtZWlcIiwgXCJqdW5pXCIsIFwianVsaVwiLCBcImF1Z3VzdHVzXCIsIFwic2VwdGVtYmVyXCIsIFwib2t0b2JlclwiLCBcIm5vdmVtYmVyXCIsIFwiZGVjZW1iZXJcIl07XHJcblxyXG4gICAgICAgICAgICAgICAgJChcIi5saXByb2R1Y3RfX3JlbGVhc2VkYXRlXCIpLmFwcGVuZChkLmdldERheSgpICsgXCIgXCIgKyBtb250aHNbZC5nZXRNb250aCgpXSArIFwiIFwiICsgZC5nZXRGdWxsWWVhcigpKTtcclxuICAgICAgICAgICAgICAgICQoXCIubGlwcm9kdWN0X19wZWdpXCIpLmFwcGVuZChwcm9kdWN0LnBlZ2lfYWdlKTtcclxuICAgICAgICAgICAgICAgICQoXCIubGlwcm9kdWN0X19wdWJsaXNoZXJcIikuYXBwZW5kKHByb2R1Y3QucHVibGlzaGVyKTtcclxuICAgICAgICAgICAgICAgICQoXCIubGlwcm9kdWN0X190aXRsZVwiKS5hcHBlbmQocHJvZHVjdC50aXRsZSk7XHJcbiAgICAgICAgICAgICAgICAkKFwiLmxpcHJvZHVjdF9fc3VidGl0bGVcIikuYXBwZW5kKHByb2R1Y3Quc3VidGl0bGUpO1xyXG4gICAgICAgICAgICAgICAgJChcIi5saXByb2R1Y3RfX2dlbnJlXCIpLmFwcGVuZChwcm9kdWN0LmdlbnJlKTtcclxuICAgICAgICAgICAgICAgICQoXCIubGlwcm9kdWN0X19mcmFuY2hpc2VcIikuYXBwZW5kKHByb2R1Y3QuZnJhbmNoaXNlKTtcclxuXHJcbiAgICAgICAgICAgICAgICAkKFwiLnByb2R1Y3RfX2Rlc2NyXCIpLmh0bWwocHJvZHVjdC5kZXNjcmlwdGlvbik7XHJcblxyXG5cclxuICAgICAgICAgICAgICAgIC8qXHJcbiAgICAgICAgICAgICAgICAkKHByb2QpLmZpbmQoXCIucHJvZHVjdF9fcHJpY2VcIikuaHRtbChwcm9kdWN0LnByaWNlKTtcclxuICAgICAgICAgICAgICAgICQocHJvZCkuZmluZChcIi5wcm9kdWN0X19pbWFnZSBpbWdcIikuYXR0cihcInNyY1wiLCBwcm9kdWN0LmltYWdlKTtcclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuICAgICAgICAgICAgICAgIC8vIENsb25lIHByb2R1Y3RcclxuICAgICAgICAgICAgICAgIHZhciBwcm9kID0gJCgnPGRpdj4nKS5hcHBlbmQoJCgnI3Byb2R1Y3RfX2xpc3RfX2l0ZW0nKS5jbG9uZSgpKTtcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgLy8gQWRkIHByb2R1Y3QgaW5mb1xyXG4gICAgICAgICAgICAgICAgJChwcm9kKS5maW5kKFwiLnByb2R1Y3RfX3RpdGxlXCIpLmh0bWwocHJvZHVjdC50aXRsZSk7XHJcbiAgICAgICAgICAgICAgICAkKHByb2QpLmZpbmQoXCIucHJvZHVjdF9fcHJpY2VcIikuaHRtbCh2YWx1ZS5wcmljZSk7XHJcbiAgICAgICAgICAgICAgICAkKHByb2QpLmZpbmQoXCIucHJvZHVjdF9faW1hZ2UgaW1nXCIpLmF0dHIoXCJzcmNcIiwgdmFsdWUuaW1hZ2UpO1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAvLyBEZXRlcm1pbiB3aGF0IHdlIGhhdmUgdG8gZG8gd2l0aCB0aGUgcm93c1xyXG4gICAgICAgICAgICAgICAgaWYgKGtleSAlIDQgPT0gMCAmJiBrZXkgPT0gMClcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAkKFwiI3Byb2R1Y3RfX2xpc3RcIikuYXBwZW5kKFwiPGRpdiBjbGFzcz0ncm93Jz5cIiArIHByb2QuaHRtbCgpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGtleSAlIDQgPT0gMClcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAkKFwiI3Byb2R1Y3RfX2xpc3RcIikuYXBwZW5kKFwiPC9kaXY+PGRpdiBjbGFzcz0ncm93Jz5cIiArIHByb2QuaHRtbCgpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAkKFwiI3Byb2R1Y3RfX2xpc3QgZGl2LnJvd1wiKS5sYXN0KCkuYXBwZW5kKHByb2QuaHRtbCgpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIENsb3NlIHRoZSBsYXN0IHJvd1xyXG4gICAgICAgICAgICAkKFwiPC9kaXY+XCIpLmFwcGVuZFRvKFwiI3Byb2R1Y3RfX2xpc3RcIik7XHJcblxyXG4gICAgICAgICAgICAvLyBSZW1vdmUgdGhlIGZpcnN0IGxpc3QgaXRlbSwgYmVjYXVzZSB0aGlzIGl0ZW0gaXMgYWx3YXlzIGVtcHR5XHJcbiAgICAgICAgICAgICQoXCIjcHJvZHVjdF9fbGlzdF9faXRlbVwiKS5maXJzdCgpLnJlbW92ZSgpOyovXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG5cclxuICAgIC8vIFJldHVybiB0aGUgbWV0aG9kcyB0aGF0IGNhbiBiZSB1c2VkIGJ5IG90aGVyIHByb2dyYW1zICh0aGUgY29udHJvbGxlciBpbiB0aGlzIGNhc2UpXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIHNldFZpZXc6IHNldFZpZXcsXHJcbiAgICAgICAgbG9hZFByb2R1Y3QgOiBsb2FkUHJvZHVjdFxyXG4gICAgfVxyXG59OyJdfQ==
